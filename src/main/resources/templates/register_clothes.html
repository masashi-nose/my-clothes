<!DOCTYPE html>
<html lang="ja" xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="utf-8" />
<meta name="viewport"
	content="width=device-width, initial-scale=1, shrink-to-fit=no" />
<meta name="description" content="" />
<meta name="author" content="" />
<title>MYQLO | アイテム新規登録</title>
<link rel="icon" type="image/x-icon"
	href="../static/dist/assets/img/myqlo_favicon.jpg"
	th:href="@{/dist/assets/img/myqlo_favicon.jpg}" />
<!-- Font Awesome icons (free version)-->
<script src="https://use.fontawesome.com/releases/v5.13.0/js/all.js"
	crossorigin="anonymous"></script>
<!-- Google fonts-->
<link href="https://fonts.googleapis.com/css?family=Montserrat:400,700"
	rel="stylesheet" type="text/css" />
<link
	href="https://fonts.googleapis.com/css?family=Droid+Serif:400,700,400italic,700italic"
	rel="stylesheet" type="text/css" />
<link
	href="https://fonts.googleapis.com/css?family=Roboto+Slab:400,100,300,700"
	rel="stylesheet" type="text/css" />
<!-- Core theme CSS (includes Bootstrap)-->
<link href="../static/dist/css/styles.css"
	th:href="@{/dist/css/styles.css}" rel="stylesheet" />

<link href="../static/dist/css/register_clothes.css" rel="stylesheet"
	th:href="@{/dist/css/register_clothes.css}" />

<link rel="stylesheet"
	href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
<link rel="stylesheet" href="/resources/demos/style.css">

<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
<script type="text/javascript"
	src="../static/dist/js/register_clothes.js"
	th:src="@{/dist/js/register_clothes.js}" /></script>

<script type="text/javascript">
//aモーダルの画像表示
$(function() {
$('#myImage').on('change', function (e) {
    var reader = new FileReader();
    reader.onload = function (e) {
        $("#preview").attr('src', e.target.result);
        var a =  document.getElementById('preview').value;
    }
    reader.readAsDataURL(e.target.files[0]);
});
});

//a選択必須項目が入力されていなかったらモーダルに遷移できなくする
$(function() {
	console.log("aaaa");
	$('#confirm').prop('disabled', true);
	$("#category").on("change",function(){
		change();
	});
	$("#brand").on("change",function(){
		change();
	});
	$("#color").on("change",function(){
		change();
	});
	$("#price").on("change",function(){
		change();
	});
});
	
	//画像が入っているか確認.
	$(function() {
		$("#myImage").change(function (){
		 var fileName = $(this).val();
		 console.log(fileName);
		 $("#fileName").val(fileName);
		 change();
	 });
		});
	function change(){
		　var category = document.getElementById('category').value;
		console.log(category);
		 var color = document.getElementById('color').value;
		 console.log(color);
		 var brand = document.getElementById( "brand" ).value ;
		 brand=brand.replace(/^\s+/,"");
		 var image = document.getElementById('myImage').value;
		 console.log(Image);
		 
		 if(!category||!color||!brand||!image){
			 $('#confirm').prop('disabled', true);
			 console.log("押せない");
		 }else{
			 $('#confirm').prop('disabled', false);
			 console.log("押せる");
		 }
	};
		
</script>
<script type="text/javascript">
//a選択必須項目を選択しないとモーダルに移動できない使用にしたため不要*/
function func1(){
	// a入力された値をモーダルの画面に映す
	$("#category2").val($("#category").val());
	$("#brand2").val($("#brand").val());
    $("#color2").val($("#color").val());
    $("#tag11").val($("#tag1").val());
    $("#tag22").val($("#tag2").val());
    $("#tag33").val($("#tag3").val());
    $("#size2").val($("#size").val());
    $("#perchaseDate2").val($("#perchaseDate").val());
    $("#price2").val($("#price").val());
    $("#comment2").val($("#comment").val());
	console.log("モーダルへ");
	　const category = document.getElementById('category').value;
	 const color = document.getElementById('color').value;
	 var brand = document.getElementById( "brand" ).value ;
	  if(category.length < 1 || color.length <1){
		  var msg = document.getElementById("message");
		  msg.innerHTML = "選択、または入力されていない項目があります";
	    console.log('選択されていない要素があります');
	    form1.submit;
	  }else{
		  console.log('すべて選択されています')
	  }
}	  
	  
var today = new Date();
var dd = today.getDate();
var mm = today.getMonth()+1; //January is 0!
var yyyy = today.getFullYear();
 if(dd<10){
        dd='0'+dd
    } 
    if(mm<10){
        mm='0'+mm
    } 

today = yyyy+'-'+mm+'-'+dd;
consolo.log(today);
document.getElementById("perchaseDate").setAttribute("max", today);
	

</script>
</head>
<body>

	<!-- Navigation-->
	<div id="navArea">
		<nav class="navbar navbar-default" th:replace="header::pageheader"></nav>
	</div>

	<!-- aアイテム登録画面-->
	<section class="page-section bg-light" id="portfolio">
		<div class="container">
			<div class="text-center">
				<h2 class="section-heading text-uppercase">アイテム新規登録</h2>
			</div>
			<form action="#" method="post" id="form1"
				th:action="@{/registerClothes/register}"
				th:object="${registerClothesForm}" enctype="multipart/form-data" onsubmit="return false;">
				<div class="required-information">
					<img id="preview" class="img-fluid"> <br>
				</div>
				<div class="image-information">
					<div class="file_button">
						画像を登録 <input name="imageFile" class="file_input" type="file"
							accept=".jpg,.png" id="myImage" th:field="*{imageFile}" required>
					</div>
				</div>

				<div>

					<table>

						<tr>
							<th class="thead" scope="col" colspan="2">基本情報（必須）</th>
						</tr>

						<tbody>
							<tr>
								<th>カテゴリー</th>
								<td class="txt"><label for="category"
									th:errors="*{category}" style="color: red"></label>
									<div class="cp_ipselect cp_sl02">
										<select name="category" id="category">
											<option th:value="null">--</option>
											<option th:each="category :${categoryList}"
												th:text="${category.name}" th:value="${category.id}"
												th:field="*{category}">アクセサリー</option>
										</select>
									</div></td>

							</tr>
							<tr class="inputarea">
								<th>
									<div>ブランド</div>
									<div th:if="${message}!=null" th:text="${message}"
										style="color: red">
										<div id="duplicateMessage" style="color: red;"></div>
								</th>
								<td class="txt"><label for="brand" th:errors="*{brand}"
									style="color: red"></label>
									<div class="search">
										<input type="text" class="search-form" name="brand" id="brand"
											th:field="*{brand}">
									</div></td>
							</tr>
							<tr>
								<th>カラー</th>
								<td class="txt"><label for="color" th:errors="*{color}"
									style="color: red"></label>
									<div class="cp_ipselect cp_sl02">
										<select name="color" id="color">
											<option th:value="null">--</option>
											<option th:each="color :${colorList}" th:text="${color.name}"
												th:value="${color.id}" th:field="*{color}">レッド</option>
										</select>
									</div></td>
							</tr>
						</tbody>
					</table>
				</div>

				<br> <br>
				<div class="detailed-information">
					<table>
						<tr>
							<th class="thead" scope="col" colspan="2">詳細情報</th>
						</tr>
						<tbody>
							<tr class="inputarea">
								<th>タグ1</th>
								<td class="txt">
									<div class="search">
										<input type="text" class="search-form" name="tag1" id="tag1">
									</div>
								</td>
							</tr>
							<tr class="inputarea">
								<th>タグ2</th>
								<td class="txt">
									<div class="search">

										<input type="text" class="search-form" name="tag2" id="tag2">
									</div>
								</td>
							</tr>
							<tr class="inputarea">
								<th>タグ3</th>
								<td class="txt  border-top-0">
									<div class="search">
										<input type="text" class="search-form" name="tag3" id="tag3">

									</div>
								</td>
							</tr>
							<tr>
								<th>シーズン</th>
								<td class="txt" id="seasons"><input type="radio"
									name="season" th:value="春" th:checked="${season=='春'}"
									id="season" onchange="chk1(this.value)">春&emsp; <input
									type="radio" name="season" th:value="夏"
									th:checked="${season=='夏'}" id="season"
									onchange="chk1(this.value)">夏&emsp; <input type="radio"
									name="season" th:value="秋" th:checked="${season=='秋'}"
									id="season" onchange="chk1(this.value)">秋&emsp; <input
									type="radio" name="season" th:value="冬"
									th:checked="${season=='冬'}" id="season"
									onchange="chk1(this.value)">冬</td>
							</tr>
							<tr>
								<th>サイズ</th>
								<td class="txt" name="size">
									<div class="cp_ipselect cp_sl02">
										<select name="size" id="size">
											<option value="">--</option>
											<option th:each="size:${sizeList}" th:text="${size.name}"
												th:value="${size.id}" th:field="*{size}">XS</option>
										</select>
									</div>
								</td>
							</tr>
							<tr>
								<th>購入日</th>
								<td class="txt"><input type="date" name="perchaseDate"
									id="perchaseDate" th:field="*{perchaseDate}"></td>
								<script type="text/javascript">
									//a今日日付以降は選択できないように設定
									perchaseDate.max = new Date().toISOString().split("T")[0];
									console.log(new Date());
									console.log(new Date().toISOString());
									console.log(new Date().toISOString().split("T")[0]);
									</script>
							</tr>
							<tr>
								<th>価格</th>

								<td class="txt"><label for="price" th:errors="*{price}"
									style="color: red"></label> <input type="number" name="price"
									th:field="*{price}" id="price"></td>
							</tr>
							<tr>
								<th>メモ</th>
								<td class="txt"><label for="comment" th:errors="*{comment}"
									style="color: red"></label> <textarea rows="10" name="comment"
										cols="30" th:field="*{comment}" id="comment"></textarea></td>
							</tr>
						</tbody>
					</table>
				</div>

				<!-- a 切り替えボタンの設定 -->
				<div class="switch_btn">
					<button type="button" class="btn btn-primary" data-toggle="modal"
						data-target="#staticBackdrop" onclick="func1()" id="confirm">確認</button>
				</div>
				<!--a モーダルの設定 -->
				<div class="modal fade" id="staticBackdrop" data-backdrop="static"
					data-keyboard="false" tabindex="-1" role="dialog"
					aria-labelledby="staticBackdropLabel" aria-hidden="true">
					<div class="modal-dialog modal-dialog-fluid">
						<div class="modal-content">
							<div class="modal-header">
								<h5 class="modal-title" id="staticBackdropLabel">アイテム登録確認画面</h5>
								<button type="button" class="close" data-dismiss="modal"
									aria-label="閉じる">
									<span aria-hidden="true">&times;</span>
								</button>
							</div>


							<!-- aこっからモーダル -->
							<div class="modal-body">
								<div>
									<div class="image-information">
										<img id="preview">
										<script type="text/javascript">
										/*a 表示の画像サイズを指定する*/
										var targetImg = document.getElementById('preview');
										targetImg.width = 250;
										targetImg.height = 300;
										</script>
										<!-- accept=".jpg,.png,image/jpeg,image/png"
											th:errorclass="error-input" -->
									</div>
									<div>

										<table>
											<tr>
												<th class="thead" scope="col" colspan="2">基本情報（必須）</th>
											</tr>
											<tbody>
												<tr>
													<th>カテゴリー</th>
													<td class="txt">
														<div class="cp_ipselect cp_sl02">
															<select id="category2" disabled="disabled">
																<option th:value="null"></option>
																<option th:each="category :${categoryList}"
																	th:text="${category.name}" th:value="${category.id}"
																	th:field="*{category}">アクセサリー</option>
															</select>
														</div>
													</td>
												</tr>
												<tr class="inputarea">
													<th>ブランド</th>
													<td class="txt">
														<div class="search">
															<input type="text" class="search-form" id="brand2"
																disabled="disabled">
														</div>
													</td>
												</tr>
												<tr>
													<th>カラー</th>
													<td class="txt">
														<div class="cp_ipselect cp_sl02">
															<select id="color2" disabled="disabled">
																<option th:value="null"></option>
																<option th:each="color :${colorList}"
																	th:text="${color.name}" th:value="${color.id}"
																	th:field="*{color}">レッド</option>
															</select>
														</div>
													</td>
												</tr>
											</tbody>
										</table>
									</div>
									<br> <br>
									<div>
										<table>
											<tr>
												<th class="thead" scope="col" colspan="2">詳細情報</th>
											</tr>
											<tbody>
												<tr class="inputarea">
													<th>タグ1</th>
													<td class="txt">
														<div class="search">
															<input type="text" class="search-form" id="tag11"
																disabled="disabled">
														</div>
													</td>
												</tr>
												<tr class="inputarea">
													<th>タグ2</th>
													<td class="txt">
														<div class="search">
															<input type="text" class="search-form" id="tag22"
																disabled="disabled">
														</div>
													</td>
												</tr>
												<tr class="inputarea">
													<th>タグ3</th>
													<td class="txt  border-top-0">
														<div class="search">
															<input type="text" class="search-form" id="tag33"
																disabled="disabled">
														</div>
													</td>
												</tr>
												<tr>
													<th>シーズン</th>
													<td class="txt"><span id="season2"
														style="color: black"></span> <script>
													function chk1(val) {
  													document.getElementById("season2").textContent = val;
													}
													</script></td>
												</tr>
												<tr>
													<th>サイズ</th>
													<td class="txt">
														<div class="cp_ipselect cp_sl02">
															<select id="size2" disabled="disabled">
																<option></option>
																<option th:each="size:${sizeList}"
																	th:text="${size.name}" th:value="${size.id}"
																	th:field="*{size}">XS</option>
															</select>
														</div>
													</td>
												</tr>
												<tr>
													<th>購入日</th>
													<td class="txt"><input type="date" id="perchaseDate2"
														disabled="disabled"></td>
												</tr>
												<tr>
													<th>価格</th>
													<td class="txt"><input type="text" id="price2"
														disabled="disabled"></td>
												</tr>
												<tr>
													<th>メモ</th>
													<td class="txt"><textarea rows="10" cols="30"
															id="comment2" disabled="disabled"></textarea></td>
												</tr>
											</tbody>
										</table>
									</div>
								</div>
							</div>

							<!-- モーダル画面内フッター -->
							<div class="modal-footer">
								<div class="comp_btn">
									<button type="submit" class="btn btn-primary" onclick="submit();">登録</button>
								</div>
							</div>
						</div>
					</div>
			</form>
		</div>
	</section>

	<!-- Footer-->
	<footer class="footer py-4" th:replace="footer::pagefooter"> </footer>

	<!-- Bootstrap core JS-->
	<script
		src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
	<script
		src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.bundle.min.js"></script>
	<!-- Third party plugin JS-->
	<script
		src="https://cdnjs.cloudflare.com/ajax/libs/jquery-easing/1.4.1/jquery.easing.min.js"></script>
	<!-- Contact form JS-->
	<script src="../static/dist/assets/mail/jqBootstrapValidation.js"
		th:src="@{dist/assets/mail/jqBootstrapValidation.js}"></script>
	<script src="../static/dist/assets/mail/contact_me.js"
		th:src="@{/dist/assets/mail/contact_me.js}"></script>
	<!-- Core theme JS-->
	<script src="../static/dist/js/scripts.js"
		th:src="@{/dist/js/scripts.js}"></script>
	<script src="../static/dist/js/hamburger_menu.js"
		th:src="@{/dist/js/hamburger_menu.js}"></script>
	<script src="../static/dist/js/vuemore.js"
		th:src="@{/dist/js/vuemore.js}"></script>


	<!-- brand用オートコンプリート なぜかhead内だと起動しない -->
	<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
	<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
	<script type="text/javascript">
$( function() {
    var brands= [ [(${brandListForAutocomplete})] ];
    var tagContents= [ [(${tagContentsListForAutocomplete})] ];
    $( "#brand" ).autocomplete({
      source: brands
    });
    $( "#tag1" ).autocomplete({
        source: tagContents
     });
    $( "#tag2" ).autocomplete({
        source: tagContents
     });
    $( "#tag3" ).autocomplete({
        source: tagContents
     });
  });
  
</script>

</body>
</html>
